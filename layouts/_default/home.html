{{ define "main" }}
<h1>{{ .Site.Title }}</h1>

<div class="filter-bar">
  <input type="text" class="filter-search" placeholder="Search by event name..." id="frame-search">
</div>

<div class="gallery">
  {{ range where .Site.RegularPages.ByDate.Reverse "Section" "frames" }}
  {{ $img := .Resources.GetMatch "frame.*" }}
  {{ $alt := .RawContent | plainify | strings.TrimSpace }}
  <div class="gallery-card" data-title="{{ .Title | lower }}">
    <a href="{{ .RelPermalink }}">
      {{ with $img }}
        <img src="{{ .RelPermalink }}" alt="{{ $alt }}" loading="lazy">
      {{ end }}
      <div class="card-label">
        {{ .Title }}
        <span class="timestamp">{{ .Params.timestamp }}</span>
      </div>
    </a>
  </div>
  {{ end }}
</div>

<script>
  const searchInput = document.getElementById('frame-search');
  searchInput.addEventListener('input', (e) => {
    const query = e.target.value.toLowerCase();
    document.querySelectorAll('.gallery-card').forEach(card => {
      const { title } = card.dataset;
      card.style.display = title.includes(query) ? '' : 'none';
    });
  });
</script>
{{ end }}
